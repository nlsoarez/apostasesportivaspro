openapi: 3.1.0
info:
  title: Apostas Esportivas Pro API
  version: "5.0"
  description: |
    API profissional para anÃ¡lises esportivas completas com:
    - âš½ Dados em tempo real de 50+ ligas
    - ðŸ“Š EstatÃ­sticas avanÃ§adas e previsÃµes IA
    - ðŸ’° Value Betting e anÃ¡lises profissionais
    - ðŸ“° Contexto de notÃ­cias e lesÃµes
    - ðŸŽ¯ IntegraÃ§Ã£o perfeita com ChatGPT
  contact:
    name: API Support
    url: https://github.com/nlsoarez/apostasesportivaspro
  license:
    name: Open Source - Uso Educacional
    url: https://github.com/nlsoarez/apostasesportivaspro

servers:
  - url: https://apostasesportivas.vercel.app
    description: Servidor de ProduÃ§Ã£o (Vercel)

tags:
  - name: health
    description: Monitoramento e status da API
  - name: fixtures
    description: Jogos e partidas
  - name: standings
    description: ClassificaÃ§Ã£o e tabelas
  - name: teams
    description: Times e estatÃ­sticas
  - name: players
    description: Jogadores e artilheiros
  - name: injuries
    description: LesÃµes e suspensÃµes
  - name: odds
    description: CotaÃ§Ãµes e odds
  - name: predictions
    description: PrevisÃµes IA
  - name: analysis
    description: AnÃ¡lises profissionais
  - name: news
    description: NotÃ­cias e contexto

paths:
  /:
    get:
      summary: DocumentaÃ§Ã£o da API
      description: Retorna informaÃ§Ãµes sobre a API e lista de endpoints disponÃ­veis
      operationId: getApiInfo
      tags:
        - health
      responses:
        "200":
          description: InformaÃ§Ãµes da API
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  name:
                    type: string
                    example: "Apostas Esportivas Pro API"
                  version:
                    type: string
                    example: "5.0"
                  description:
                    type: string
                  endpoints:
                    type: object

  /health:
    get:
      summary: Verifica status da API
      description: Health check bÃ¡sico para monitoramento
      operationId: checkHealth
      tags:
        - health
      responses:
        "200":
          description: API operacional
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "API operacional"

  /fixtures:
    get:
      summary: Lista jogos por data, liga ou rodada
      description: |
        Busca jogos filtrados por:
        - Data especÃ­fica (YYYY-MM-DD)
        - Rodada da competiÃ§Ã£o
        - Status (NS=agendado, LIVE=ao vivo, FT=finalizado)
      operationId: getFixtures
      tags:
        - fixtures
      parameters:
        - name: league
          in: query
          required: true
          description: ID da liga (ex. 71=BrasileirÃ£o, 39=Premier League)
          schema:
            type: integer
            example: 71
        - name: date
          in: query
          required: false
          description: Data dos jogos no formato YYYY-MM-DD
          schema:
            type: string
            format: date
            example: "2025-11-13"
        - name: round
          in: query
          required: false
          description: Rodada da competiÃ§Ã£o (alternativa a date)
          schema:
            type: string
            example: "Regular Season - 34"
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
        - name: status
          in: query
          required: false
          description: Status do jogo (NS, LIVE, FT, PST, CANC, etc.)
          schema:
            type: string
            enum: [NS, LIVE, FT, PST, CANC, ABD, AWD, WO, TBD]
            example: "LIVE"
        - name: timezone
          in: query
          required: false
          description: Fuso horÃ¡rio para datas
          schema:
            type: string
            default: "America/Sao_Paulo"
            example: "America/Sao_Paulo"
      responses:
        "200":
          description: Lista de jogos encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  total:
                    type: integer
                    example: 10
                  jogos:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1234567
                        data:
                          type: string
                          format: date-time
                          example: "2025-11-13T20:00:00-03:00"
                        status:
                          type: string
                          example: "NS"
                        mandante:
                          type: string
                          example: "Flamengo"
                        visitante:
                          type: string
                          example: "Palmeiras"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /fixtures/headtohead:
    get:
      summary: HistÃ³rico de confrontos diretos (H2H)
      description: Retorna os Ãºltimos 10 jogos entre dois times
      operationId: getHeadToHead
      tags:
        - fixtures
      parameters:
        - name: h2h
          in: query
          required: true
          description: IDs dos times no formato "idTimeA-idTimeB"
          schema:
            type: string
            pattern: '^\d+-\d+$'
            example: "127-121"
      responses:
        "200":
          description: HistÃ³rico de confrontos
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  total:
                    type: integer
                    example: 10
                  resultados:
                    type: array
                    items:
                      type: object
                      properties:
                        mandante:
                          type: string
                          example: "Flamengo"
                        visitante:
                          type: string
                          example: "Palmeiras"
                        placar:
                          type: string
                          example: "2x1"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /fixtures/live:
    get:
      summary: Jogos ao vivo no momento
      description: Lista os top 20 jogos que estÃ£o acontecendo agora
      operationId: getLiveFixtures
      tags:
        - fixtures
      responses:
        "200":
          description: Jogos ao vivo
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  partidas:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1234567
                        status:
                          type: string
                          example: "1H"
                        minuto:
                          type: integer
                          example: 32
                        mandante:
                          type: string
                          example: "Flamengo"
                        visitante:
                          type: string
                          example: "Palmeiras"
        "500":
          $ref: "#/components/responses/InternalError"

  /fixtures/live/analysis:
    get:
      summary: AnÃ¡lise completa de jogo ao vivo
      description: |
        AnÃ¡lise profissional de jogo em andamento incluindo:
        - EstatÃ­sticas em tempo real (posse, chutes, escanteios, cartÃµes)
        - Fator Must Win de ambos os times
        - AnÃ¡lise de momento do jogo
        - SugestÃµes contextualizadas de apostas ao vivo
      operationId: getLiveAnalysis
      tags:
        - fixtures
        - analysis
      parameters:
        - name: fixture
          in: query
          required: true
          description: ID do jogo ao vivo
          schema:
            type: integer
            example: 1234567
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: AnÃ¡lise completa do jogo ao vivo
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  jogo:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1234567
                      status:
                        type: string
                        example: "Match Finished"
                      minuto:
                        type: integer
                        example: 67
                      momento_jogo:
                        type: string
                        example: "Reta final - Momento decisivo"
                      mandante:
                        type: string
                        example: "Flamengo"
                      visitante:
                        type: string
                        example: "Palmeiras"
                      placar:
                        type: object
                        properties:
                          atual:
                            type: string
                            example: "2x1"
                          halftime:
                            type: string
                            example: "1x0"
                  estatisticas_ao_vivo:
                    type: object
                    properties:
                      mandante:
                        type: object
                      visitante:
                        type: object
                  must_win:
                    type: object
                    properties:
                      mandante:
                        type: object
                        properties:
                          score:
                            type: number
                            format: float
                            example: 7.5
                            description: "Score de 0-10 indicando pressÃ£o por resultado"
                          nivel:
                            type: string
                            enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                            example: "ALTO"
                          fatores:
                            type: array
                            items:
                              type: object
                          recomendacao:
                            type: string
                            example: "Time precisa pontuar. Fator motivacional significativo."
                      visitante:
                        type: object
                        properties:
                          score:
                            type: number
                            format: float
                            example: 5.0
                          nivel:
                            type: string
                            enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                            example: "MODERADO"
                      analise:
                        type: string
                        example: "Mais importante para Flamengo"
                  sugestoes_ao_vivo:
                    type: array
                    items:
                      type: object
                      properties:
                        tipo:
                          type: string
                          example: "Escanteios"
                        mercado:
                          type: string
                          example: "ProjeÃ§Ã£o: 11.2 escanteios no jogo"
                        justificativa:
                          type: string
                          example: "7 escanteios em 67' (ritmo de 0.10/min)"
                        confianca:
                          type: integer
                          minimum: 1
                          maximum: 5
                          example: 4
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          description: Jogo nÃ£o encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalError"

  /fixtures/live/minute-by-minute:
    get:
      summary: AnÃ¡lise minuto a minuto do jogo
      description: |
        Timeline completa de eventos e anÃ¡lise por perÃ­odos:
        - Todos os eventos (gols, cartÃµes, substituiÃ§Ãµes)
        - AnÃ¡lise por perÃ­odos (0-15, 16-30, 31-45, 46-60, 61-75, 76-90+)
        - IdentificaÃ§Ã£o de momentos-chave
        - PadrÃµes de jogo identificados
      operationId: getMinuteByMinuteAnalysis
      tags:
        - fixtures
        - analysis
      parameters:
        - name: fixture
          in: query
          required: true
          description: ID do jogo
          schema:
            type: integer
            example: 1234567
      responses:
        "200":
          description: AnÃ¡lise minuto a minuto completa
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  jogo:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1234567
                      mandante:
                        type: string
                        example: "Flamengo"
                      visitante:
                        type: string
                        example: "Palmeiras"
                      status:
                        type: string
                        example: "Match Finished"
                  timeline_completa:
                    type: array
                    items:
                      type: object
                      properties:
                        minuto:
                          type: integer
                          example: 23
                        minuto_display:
                          type: string
                          example: "23'"
                        tipo:
                          type: string
                          enum: ["Goal", "Card", "subst"]
                          example: "Goal"
                        detalhe:
                          type: string
                          example: "Normal Goal"
                        time:
                          type: string
                          example: "Flamengo"
                        jogador:
                          type: string
                          example: "Pedro"
                  analise_por_periodos:
                    type: object
                    properties:
                      "0-15":
                        type: object
                        properties:
                          gols:
                            type: integer
                            example: 1
                          cartoes:
                            type: integer
                            example: 0
                          eventos:
                            type: array
                            items:
                              type: object
                  momentos_chave:
                    type: array
                    items:
                      type: object
                      properties:
                        periodo:
                          type: string
                          example: "0-15"
                        descricao:
                          type: string
                          example: "InÃ­cio elÃ©trico com 1 gol(s)"
                        impacto:
                          type: string
                          enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                          example: "ALTO"
                  padroes_identificados:
                    type: array
                    items:
                      type: object
                      properties:
                        tipo:
                          type: string
                          example: "Gols"
                        padrao:
                          type: string
                          example: "Jogo abriu no segundo tempo"
                        dados:
                          type: string
                          example: "1 no 1ÂºT vs 2 no 2ÂºT"
                  resumo:
                    type: object
                    properties:
                      total_eventos:
                        type: integer
                        example: 23
                      total_gols:
                        type: integer
                        example: 3
                      total_cartoes:
                        type: integer
                        example: 5
                      total_substituicoes:
                        type: integer
                        example: 6
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          description: Jogo nÃ£o encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          $ref: "#/components/responses/InternalError"

  /leagues:
    get:
      summary: Ligas suportadas pela API
      description: |
        Lista todas as ligas disponÃ­veis organizadas por categoria:
        - Brasil (BrasileirÃ£o, Copa do Brasil, Estaduais)
        - Europa (Premier League, La Liga, Serie A, Bundesliga, etc)
        - Internacional (Champions, Europa League, Libertadores)
        - AmÃ©ricas (MLS, Liga MX)
        - Mundial (Copa do Mundo, Euro)
      operationId: getLeagues
      tags:
        - health
      responses:
        "200":
          description: Lista de ligas suportadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  total:
                    type: integer
                    example: 25
                  leagues:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 71
                        name:
                          type: string
                          example: "BrasileirÃ£o SÃ©rie A"
                  categories:
                    type: object
                    properties:
                      brasil:
                        type: array
                        items:
                          type: integer
                        example: [71, 72, 73, 75, 76]
                      europa:
                        type: array
                        items:
                          type: integer
                        example: [39, 140, 135, 78, 61, 94, 88]
                      internacional:
                        type: array
                        items:
                          type: integer
                        example: [2, 3, 848, 13, 11]
                      americas:
                        type: array
                        items:
                          type: integer
                        example: [253, 128]
                      mundial:
                        type: array
                        items:
                          type: integer
                        example: [1, 960]

  /standings:
    get:
      summary: ClassificaÃ§Ã£o da liga
      description: Tabela de classificaÃ§Ã£o completa com pontos, vitÃ³rias, derrotas, etc.
      operationId: getStandings
      tags:
        - standings
      parameters:
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: Tabela de classificaÃ§Ã£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  standings:
                    type: array
                    items:
                      type: object
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /teams/statistics:
    get:
      summary: EstatÃ­sticas detalhadas de um time
      description: |
        Retorna estatÃ­sticas completas incluindo:
        - Gols marcados/sofridos
        - Escanteios mÃ©dios
        - CartÃµes amarelos/vermelhos
        - Performance em casa/fora
      operationId: getTeamStatistics
      tags:
        - teams
      parameters:
        - name: team
          in: query
          required: true
          description: ID do time
          schema:
            type: integer
            example: 127
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: EstatÃ­sticas do time
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  stats:
                    type: object
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /players/topscorers:
    get:
      summary: Lista de artilheiros da liga
      description: Jogadores com mais gols na competiÃ§Ã£o
      operationId: getTopScorers
      tags:
        - players
      parameters:
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: Lista de artilheiros
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  artilheiros:
                    type: array
                    items:
                      type: object
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /injuries:
    get:
      summary: LesÃµes e suspensÃµes de um time
      description: Lista jogadores indisponÃ­veis por lesÃ£o, suspensÃ£o ou outros motivos
      operationId: getInjuries
      tags:
        - injuries
      parameters:
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: team
          in: query
          required: true
          description: ID do time
          schema:
            type: integer
            example: 127
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: Lista de lesÃµes/suspensÃµes
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  total:
                    type: integer
                    example: 5
                  lesoes:
                    type: array
                    items:
                      type: object
                      properties:
                        jogador:
                          type: string
                          example: "Neymar Jr"
                        tipo:
                          type: string
                          example: "Injury"
                        motivo:
                          type: string
                          example: "Ankle Injury"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /odds:
    get:
      summary: Odds em tempo real de um jogo
      description: CotaÃ§Ãµes de mÃºltiplas casas de apostas para um jogo especÃ­fico
      operationId: getOdds
      tags:
        - odds
      parameters:
        - name: fixture
          in: query
          required: true
          description: ID do jogo
          schema:
            type: integer
            example: 1234567
      responses:
        "200":
          description: Odds disponÃ­veis
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  odds:
                    type: array
                    items:
                      type: object
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /predictions:
    get:
      summary: PrevisÃµes IA para um jogo
      description: |
        AnÃ¡lise preditiva da API-Sports incluindo:
        - Porcentagem de vitÃ³ria de cada time
        - Forma recente
        - EstatÃ­sticas H2H
        - AnÃ¡lise de gols
      operationId: getPredictions
      tags:
        - predictions
      parameters:
        - name: fixture
          in: query
          required: true
          description: ID do jogo
          schema:
            type: integer
            example: 1234567
      responses:
        "200":
          description: PrevisÃµes geradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  predicoes:
                    type: array
                    items:
                      type: object
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /analysis/corners:
    get:
      summary: AnÃ¡lise de escanteios com fator Must Win
      description: |
        Calcula estimativa de escanteios baseado em:
        - MÃ©dia de escanteios a favor (casa)
        - MÃ©dia de escanteios a favor (fora)
        - Fator Must Win (pressÃ£o por resultado)
        - Gera sugestÃµes ajustadas pelo contexto motivacional
      operationId: getAnalysisCorners
      tags:
        - analysis
      parameters:
        - name: team_home
          in: query
          required: true
          description: ID do time mandante
          schema:
            type: integer
            example: 127
        - name: team_away
          in: query
          required: true
          description: ID do time visitante
          schema:
            type: integer
            example: 121
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: AnÃ¡lise de escanteios gerada com fator Must Win
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  analise_escanteios:
                    type: object
                    properties:
                      time_casa:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 127
                          must_win:
                            type: object
                            properties:
                              score:
                                type: number
                                format: float
                                example: 7.5
                                description: "Score de 0-10 indicando pressÃ£o por resultado"
                              nivel:
                                type: string
                                enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                                example: "ALTO"
                              fatores:
                                type: array
                                items:
                                  type: object
                                  properties:
                                    fator:
                                      type: string
                                      example: "Zona de Rebaixamento"
                                    impacto:
                                      type: string
                                      example: "CRÃTICO"
                                    descricao:
                                      type: string
                                      example: "Time na 18Âª posiÃ§Ã£o (zona de rebaixamento)"
                              recomendacao:
                                type: string
                                example: "Time precisa pontuar. Fator motivacional significativo."
                      time_fora:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 121
                          must_win:
                            type: object
                            properties:
                              score:
                                type: number
                                format: float
                                example: 5.0
                              nivel:
                                type: string
                                enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                                example: "MODERADO"
                      estimativa_total:
                        type: number
                        format: float
                        example: 10.5
                      analise_must_win:
                        type: object
                        properties:
                          impacto:
                            type: string
                            example: "Times pressionados tendem a jogar mais ofensivamente, gerando mais escanteios"
                          fator_combinado:
                            type: number
                            format: float
                            example: 6.3
                            description: "MÃ©dia do fator Must Win dos dois times"
                      sugestoes:
                        type: array
                        items:
                          type: object
                          properties:
                            mercado:
                              type: string
                              example: "Over 9.5 Escanteios Totais"
                            confianca:
                              type: number
                              format: float
                              minimum: 1
                              maximum: 5
                              example: 4.8
                              description: "ConfianÃ§a ajustada pelo fator Must Win"
                            value_estimado:
                              type: string
                              example: "+20%"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /analysis/cards:
    get:
      summary: AnÃ¡lise de cartÃµes com fator Must Win
      description: |
        Calcula estimativa de cartÃµes amarelos baseado em:
        - MÃ©dia de cartÃµes em casa
        - MÃ©dia de cartÃµes fora
        - Fator Must Win (pressÃ£o por resultado)
        - Gera sugestÃµes ajustadas pela intensidade do jogo
      operationId: getAnalysisCards
      tags:
        - analysis
      parameters:
        - name: team_home
          in: query
          required: true
          description: ID do time mandante
          schema:
            type: integer
            example: 127
        - name: team_away
          in: query
          required: true
          description: ID do time visitante
          schema:
            type: integer
            example: 121
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
      responses:
        "200":
          description: AnÃ¡lise de cartÃµes gerada com fator Must Win
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  analise_cartoes:
                    type: object
                    properties:
                      time_casa:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 127
                          must_win:
                            type: object
                            properties:
                              score:
                                type: number
                                format: float
                                example: 7.5
                                description: "Score de 0-10 indicando pressÃ£o por resultado"
                              nivel:
                                type: string
                                enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                                example: "ALTO"
                              fatores:
                                type: array
                                items:
                                  type: object
                              recomendacao:
                                type: string
                                example: "Time precisa pontuar. Fator motivacional significativo."
                      time_fora:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 121
                          must_win:
                            type: object
                            properties:
                              score:
                                type: number
                                format: float
                                example: 5.0
                              nivel:
                                type: string
                                enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                                example: "MODERADO"
                      estimativa_total:
                        type: number
                        format: float
                        example: 5.5
                      analise_must_win:
                        type: object
                        properties:
                          impacto:
                            type: string
                            example: "Times pressionados jogam com mais intensidade e agressividade, resultando em mais cartÃµes"
                          fator_combinado:
                            type: number
                            format: float
                            example: 6.3
                            description: "MÃ©dia do fator Must Win dos dois times"
                      sugestoes:
                        type: array
                        items:
                          type: object
                          properties:
                            mercado:
                              type: string
                              example: "Over 5.5 CartÃµes Totais"
                            confianca:
                              type: number
                              format: float
                              minimum: 1
                              maximum: 5
                              example: 4.9
                              description: "ConfianÃ§a ajustada pelo fator Must Win"
                            value_estimado:
                              type: string
                              example: "+25%"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /analysis/complete:
    get:
      summary: AnÃ¡lise Completa de um Jogo
      description: Retorna anÃ¡lise consolidada incluindo contexto, estatÃ­sticas, H2H, escanteios, cartÃµes, lesÃµes e previsÃµes com fator Must Win. Consolida mÃºltiplas chamadas em uma Ãºnica requisiÃ§Ã£o.
      operationId: getAnalysisComplete
      tags:
        - analysis
      parameters:
        - name: team_home
          in: query
          required: true
          description: ID do time mandante
          schema:
            type: integer
            example: 127
        - name: team_away
          in: query
          required: true
          description: ID do time visitante
          schema:
            type: integer
            example: 121
        - name: league
          in: query
          required: true
          description: ID da liga
          schema:
            type: integer
            example: 71
        - name: season
          in: query
          required: false
          description: Ano da temporada
          schema:
            type: integer
            default: 2024
            example: 2024
        - name: fixture
          in: query
          required: false
          description: ID do jogo especÃ­fico (para incluir previsÃµes IA)
          schema:
            type: integer
            example: 1234567
      responses:
        "200":
          description: AnÃ¡lise completa gerada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  jogo:
                    type: object
                    properties:
                      mandante_id:
                        type: integer
                        example: 127
                      visitante_id:
                        type: integer
                        example: 121
                      liga_id:
                        type: integer
                        example: 71
                      temporada:
                        type: string
                        example: "2024"
                  contexto:
                    type: object
                    properties:
                      classificacao:
                        type: object
                        properties:
                          mandante:
                            type: object
                            properties:
                              posicao:
                                type: integer
                                example: 3
                              pontos:
                                type: integer
                                example: 45
                          visitante:
                            type: object
                            properties:
                              posicao:
                                type: integer
                                example: 8
                              pontos:
                                type: integer
                                example: 32
                      must_win:
                        type: object
                        properties:
                          mandante:
                            type: object
                            properties:
                              score:
                                type: number
                                format: float
                                example: 7.5
                              nivel:
                                type: string
                                enum: ["CRÃTICO", "ALTO", "MODERADO", "BAIXO"]
                                example: "ALTO"
                              fatores:
                                type: array
                                items:
                                  type: object
                              recomendacao:
                                type: string
                          visitante:
                            type: object
                          analise:
                            type: string
                            example: "Mais importante para o time da casa"
                  estatisticas:
                    type: object
                    description: EstatÃ­sticas completas de ambos os times
                  confronto_direto:
                    type: object
                    properties:
                      total:
                        type: integer
                        example: 10
                      ultimos_jogos:
                        type: array
                        items:
                          type: object
                          properties:
                            data:
                              type: string
                            mandante:
                              type: string
                            visitante:
                              type: string
                            placar:
                              type: string
                              example: "2-1"
                  analise_escanteios:
                    type: object
                    properties:
                      estimativa_total:
                        type: number
                        format: float
                        example: 10.5
                      analise_must_win:
                        type: object
                        properties:
                          fator_combinado:
                            type: number
                            format: float
                            example: 6.3
                          impacto:
                            type: string
                      sugestoes:
                        type: array
                        items:
                          type: object
                          properties:
                            mercado:
                              type: string
                              example: "Over 9.5 Escanteios"
                            confianca:
                              type: number
                              example: 4.5
                            value_estimado:
                              type: string
                              example: "+15%"
                  analise_cartoes:
                    type: object
                    properties:
                      estimativa_total:
                        type: number
                        format: float
                        example: 5.5
                      sugestoes:
                        type: array
                        items:
                          type: object
                  lesoes:
                    type: object
                    properties:
                      mandante:
                        type: array
                        items:
                          type: object
                      visitante:
                        type: array
                        items:
                          type: object
                  predicoes:
                    type: object
                    nullable: true
                    description: PrevisÃµes IA (apenas se fixture fornecido)
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /analysis/value:
    get:
      summary: Calcula Value Bet
      description: |
        FÃ³rmula: (probabilidade Ã— odd) - 1
        - Resultado > 0: Aposta com valor (recomendada)
        - Resultado < 0: Sem valor (evitar)
      operationId: getValueBet
      tags:
        - analysis
      parameters:
        - name: odd
          in: query
          required: true
          description: Odd da casa de apostas (ex. 2.50)
          schema:
            type: number
            format: float
            minimum: 1.01
            example: 2.50
        - name: probability
          in: query
          required: true
          description: Probabilidade estimada (0-1, ex. 0.50 = 50%)
          schema:
            type: number
            format: float
            minimum: 0.01
            maximum: 1.0
            example: 0.50
      responses:
        "200":
          description: Value calculado
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  value:
                    type: number
                    format: float
                    example: 0.25
                    description: "Valor positivo indica value bet"
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

  /news/context:
    get:
      summary: NotÃ­cias recentes de um time
      description: |
        Busca notÃ­cias relevantes sobre:
        - LesÃµes e suspensÃµes
        - MudanÃ§as tÃ©cnicas
        - Clima do time
        - Fontes: GE, ESPN
      operationId: getNewsContext
      tags:
        - news
      parameters:
        - name: team
          in: query
          required: true
          description: Nome do time
          schema:
            type: string
            example: "Flamengo"
        - name: league
          in: query
          required: false
          description: Nome da liga (opcional)
          schema:
            type: string
            example: "BrasileirÃ£o"
        - name: days
          in: query
          required: false
          description: Ãšltimos N dias de notÃ­cias
          schema:
            type: integer
            default: 3
            minimum: 1
            maximum: 30
            example: 3
      responses:
        "200":
          description: NotÃ­cias encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  team:
                    type: string
                    example: "Flamengo"
                  league:
                    type: string
                    example: "BrasileirÃ£o"
                  total:
                    type: integer
                    example: 5
                  noticias:
                    type: array
                    items:
                      type: object
                      properties:
                        titulo:
                          type: string
                          example: "Neymar sofre lesÃ£o no tornozelo"
                        fonte:
                          type: string
                          example: "GE Globo"
                        publicado_em:
                          type: string
                          format: date-time
                          example: "2025-11-12T15:30:00Z"
                        url:
                          type: string
                          format: uri
                          example: "https://ge.globo.com/..."
        "400":
          $ref: "#/components/responses/BadRequest"
        "500":
          $ref: "#/components/responses/InternalError"

components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        ok:
          type: boolean
          example: false
        error:
          type: string
          example: "Erro ao processar requisiÃ§Ã£o"
      required:
        - ok
        - error

    SuccessResponse:
      type: object
      properties:
        ok:
          type: boolean
          example: true
      required:
        - ok

    Fixture:
      type: object
      properties:
        id:
          type: integer
          example: 1234567
        data:
          type: string
          format: date-time
          example: "2025-11-13T20:00:00-03:00"
        status:
          type: string
          example: "NS"
        mandante:
          type: string
          example: "Flamengo"
        visitante:
          type: string
          example: "Palmeiras"

    League:
      type: object
      properties:
        id:
          type: integer
          example: 71
        name:
          type: string
          example: "BrasileirÃ£o SÃ©rie A"

  responses:
    BadRequest:
      description: RequisiÃ§Ã£o invÃ¡lida - parÃ¢metros ausentes ou incorretos
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    InternalError:
      description: Erro interno do servidor ou API externa
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: Chave de API (apenas para uso interno)

security: []
